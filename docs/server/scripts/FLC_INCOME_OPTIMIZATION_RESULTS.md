# FLC × Income Matrix 클러스터링 최적화 실험 결과

## 📊 실험 개요

**목적**: 피처 중복 제거 및 최적화를 통한 클러스터링 성능 향상  
**실행일**: 2025-01-15  
**데이터**: `welcome_1st_2nd_joined.csv` (19,020명)

---

## 🎯 문제점 분석

### 기존 방식의 문제

**피처 중복 사용**:
- 18개 세그먼트 원-핫 인코딩 (Life Stage × Income Tier)에 이미 `age`와 `Q6_scaled` 정보 포함
- 추가 피처에 `age_scaled`, `Q6_scaled`를 또 사용 → **가중치 과도하게 높아짐**

**기존 결과**:
- 피처 수: 24개 (18개 세그먼트 + 6개 추가 피처)
- Silhouette Score: **0.3061**
- Davies-Bouldin Index: 1.7035

---

## 🔬 실험 설계

### 실험 1: 중복 제거 (4개 피처)
- **피처**: 18개 세그먼트 + 4개 추가 피처 = **22개**
- **제거**: `age_scaled`, `Q6_scaled`
- **유지**: `education_level_scaled`, `Q8_count_scaled`, `Q8_premium_index`, `is_premium_car`

### 실험 2: 피처 추가 (8개 피처)
- **피처**: 18개 세그먼트 + 8개 추가 피처 = **26개**
- **제거**: `age_scaled`, `Q6_scaled`
- **추가**: 라이프스타일 (`has_drinking_experience`, `is_apple_user`), 지역/가족 (`is_metro`, `has_children`)

### 실험 3: k값 최적화
- **기반**: 실험 1 또는 2 중 더 좋은 성능
- **범위**: k=3~8 테스트
- **목적**: 최적 k값 탐색

---

## 📈 실험 결과 비교

### 전체 결과 요약

| 실험 | 피처 수 | 최적 k | Silhouette Score | Davies-Bouldin Index | 평가 |
|------|---------|--------|------------------|---------------------|------|
| **기존** | 24개 | 8 | 0.3061 | 1.7035 | 중복 있음 |
| **실험 1** | **22개** | **8** | **0.2759** | **1.8154** | ⚠️ 약간 하락 |
| **실험 2** | 26개 | 8 | 0.2388 | 1.8094 | ⚠️ 하락 |
| **실험 3** | 22개 | 8 | 0.2759 | 1.8154 | 실험 1과 동일 |

### k값별 상세 결과 (실험 3)

| k | Silhouette Score | Davies-Bouldin Index | Calinski-Harabasz Index | Inertia |
|---|------------------|---------------------|------------------------|---------|
| 3 | 0.0882 | 3.0928 | 1185.89 | 372,039.98 |
| 4 | 0.0935 | 2.6790 | 1195.46 | 352,045.24 |
| 5 | 0.1779 | 2.4422 | 1261.64 | 330,678.61 |
| 6 | 0.2128 | 1.6601 | 1323.90 | 310,383.45 |
| 7 | 0.2647 | 1.9467 | 1418.18 | 289,069.96 |
| **8** | **0.2759** | **1.8154** | **1516.47** | **268,515.06** |

**결론**: k=8이 최적값

---

## ⚠️ 예상과 다른 결과

### 예상
- 실험 1: Silhouette Score 0.32~0.35 예상
- 실험 2: Silhouette Score 0.35~0.40 예상

### 실제 결과
- 실험 1: **0.2759** (기존 0.3061 대비 **-9.9% 하락**)
- 실험 2: **0.2388** (기존 0.3061 대비 **-22.0% 하락**)

### 원인 분석

1. **age_scaled와 Q6_scaled의 정보 손실**
   - 생애주기와 소득 계층은 **범주형 분류** (6단계, 3분위)
   - 연속형 `age_scaled`, `Q6_scaled`는 **세밀한 정보** 제공
   - 제거 시 세밀한 구분력 감소

2. **피처 추가의 역효과**
   - `has_drinking_experience`, `is_apple_user`, `is_metro`, `has_children` 추가
   - 오히려 노이즈 증가 또는 생애주기/소득 정보와의 상관관계로 인한 혼선

3. **18개 세그먼트의 정보량**
   - 18개 세그먼트 원-핫 인코딩만으로도 충분한 정보 제공
   - 추가 피처가 오히려 클러스터 구분을 모호하게 만듦

---

## 💡 주요 인사이트

### 1. 중복이 오히려 도움이 될 수 있음

**Kim & Lee (2023) 논문과의 차이**:
- 논문: 18개 세그먼트만 사용 (age, income 연속형 제외)
- 우리 실험: 18개 세그먼트 + 연속형 age, income 추가
- **결과**: 연속형 정보가 세밀한 구분에 도움

**이유**:
- 생애주기 단계는 **범주형** (예: 20-29세 = Stage 1)
- 하지만 **연속형 age**는 세밀한 차이 반영 (예: 23세 vs 28세)
- 소득 계층도 **범주형** (예: Low, Mid, High)
- 하지만 **연속형 Q6_scaled**는 세밀한 소득 차이 반영

### 2. 피처 추가의 역효과

**실험 2 결과 분석**:
- Silhouette Score: 0.2388 (실험 1 대비 -13.4%)
- 추가 피처가 오히려 성능 저하

**가능한 원인**:
- `has_children`: 이미 생애주기 단계에 포함됨
- `is_metro`, `has_drinking_experience`, `is_apple_user`: 생애주기/소득과 독립적이지 않음
- 노이즈 증가 또는 다중공선성 문제

### 3. 최적 k값은 8

**k값별 성능**:
- k=3~5: Silhouette Score 0.09~0.18 (너무 낮음)
- k=6: 0.2128 (보통)
- k=7: 0.2647 (양호)
- k=8: **0.2759** (최고)

**결론**: k=8이 최적값이며, 더 많은 k는 테스트 필요

---

## 📊 최종 클러스터 프로필 (실험 1, k=8)

### Cluster 0: "시니어 저소득층" (7.7%)

| 특성 | 값 |
|------|-----|
| **크기** | 1,459명 (7.7%) |
| **평균 연령** | 66.3세 |
| **평균 소득** | 173만원 |
| **자녀 있음** | 72.8% |
| **프리미엄 지수** | 0.092 |
| **생애주기** | Seniors 100% |
| **소득 계층** | Low 100% |

---

### Cluster 1: "젊은 싱글 저소득층" (17.7%)

| 특성 | 값 |
|------|-----|
| **크기** | 3,359명 (17.7%) |
| **평균 연령** | 23.2세 |
| **평균 소득** | 121만원 |
| **자녀 있음** | 4.1% |
| **프리미엄 지수** | 0.117 |
| **생애주기** | Young Singles 100% |
| **소득 계층** | Low 100% |

---

### Cluster 2: "중장년 가족 중고소득층" (32.5%) ⭐ 최대 클러스터

| 특성 | 값 |
|------|-----|
| **크기** | 6,185명 (32.5%) |
| **평균 연령** | 50.4세 |
| **평균 소득** | 508만원 |
| **자녀 있음** | 89.0% |
| **프리미엄 지수** | 0.153 |
| **생애주기** | Mature Parents 46%, Seniors 25% |
| **소득 계층** | High 62.3%, Mid 37.7% |

---

### Cluster 3: "젊은 부모 저소득층" (5.8%)

| 특성 | 값 |
|------|-----|
| **크기** | 1,112명 (5.8%) |
| **평균 연령** | 37.9세 |
| **평균 소득** | 168만원 |
| **자녀 있음** | 100% |
| **프리미엄 지수** | 0.154 |
| **생애주기** | Young Parents 100% |
| **소득 계층** | Low 100% |

---

### Cluster 4: "DINK 저중소득층" (18.2%)

| 특성 | 값 |
|------|-----|
| **크기** | 3,453명 (18.2%) |
| **평균 연령** | 39.9세 |
| **평균 소득** | 311만원 |
| **자녀 있음** | 0% |
| **프리미엄 지수** | 0.109 |
| **생애주기** | DINK 74%, Middle Age 26% |
| **소득 계층** | Low 61.0%, Mid 12.4%, High 26.6% |

---

### Cluster 5: "중장년 부모 저소득층" (8.1%)

| 특성 | 값 |
|------|-----|
| **크기** | 1,535명 (8.1%) |
| **평균 연령** | 52.4세 |
| **평균 소득** | 185만원 |
| **자녀 있음** | 100% |
| **프리미엄 지수** | 0.115 |
| **생애주기** | Mature Parents 100% |
| **소득 계층** | Low 100% |

---

### Cluster 6: "중장년 무자녀 저소득층" (6.1%)

| 특성 | 값 |
|------|-----|
| **크기** | 1,162명 (6.1%) |
| **평균 연령** | 51.4세 |
| **평균 소득** | 176만원 |
| **자녀 있음** | 0% |
| **프리미엄 지수** | 0.066 |
| **생애주기** | Middle Age 100% |
| **소득 계층** | Low 100% |

---

### Cluster 7: "DINK 중소득층" (4.0%)

| 특성 | 값 |
|------|-----|
| **크기** | 755명 (4.0%) |
| **평균 연령** | 35.8세 |
| **평균 소득** | 350만원 |
| **자녀 있음** | 0% |
| **프리미엄 지수** | 0.123 |
| **생애주기** | DINK 100% |
| **소득 계층** | Mid 100% |

---

## 🔍 실험별 상세 분석

### 실험 1: 중복 제거 (22개 피처)

**결과**:
- Silhouette Score: **0.2759**
- Davies-Bouldin Index: 1.8154
- 최적 k: 8

**특징**:
- 기존 방식 (0.3061) 대비 **-9.9% 하락**
- 하지만 클러스터 해석은 더 명확할 수 있음 (중복 제거로 인한)

**클러스터 분포**:
- Cluster 2가 32.5%로 가장 큼 (중장년 가족 중고소득층)
- Cluster 7이 4.0%로 가장 작음 (DINK 중소득층)

---

### 실험 2: 피처 추가 (26개 피처)

**결과**:
- Silhouette Score: **0.2388**
- Davies-Bouldin Index: 1.8094
- 최적 k: 8

**특징**:
- 기존 방식 (0.3061) 대비 **-22.0% 하락**
- 실험 1 (0.2759) 대비 **-13.4% 하락**

**원인 추정**:
- 추가 피처 (`has_drinking_experience`, `is_apple_user`, `is_metro`, `has_children`)가 노이즈 증가
- 생애주기/소득 정보와의 상관관계로 인한 혼선

---

### 실험 3: k값 최적화

**결과**:
- 실험 1 기반으로 k=3~8 테스트
- 최적 k: **8** (Silhouette Score: 0.2759)

**k값별 성능**:
- k=3~5: 성능 낮음 (0.09~0.18)
- k=6: 0.2128 (보통)
- k=7: 0.2647 (양호)
- k=8: **0.2759** (최고)

**결론**: k=8이 최적값이며, 더 많은 클러스터는 테스트 필요

---

## 📊 기존 방식 vs 최적화 방식 비교

| 항목 | 기존 방식 | 최적화 방식 (실험 1) | 차이 |
|------|----------|---------------------|------|
| **피처 수** | 24개 | 22개 | -2개 |
| **중복 피처** | age_scaled, Q6_scaled 포함 | 제거 | ✅ |
| **Silhouette Score** | 0.3061 | 0.2759 | -9.9% |
| **Davies-Bouldin Index** | 1.7035 | 1.8154 | +6.6% |
| **최적 k** | 8 | 8 | 동일 |
| **클러스터 해석** | 중복으로 인한 모호성 | 더 명확 | ✅ |

---

## 💡 결론 및 권장사항

### 1. 중복 제거의 효과

**예상과 다른 결과**:
- 중복 제거 시 Silhouette Score가 **하락** (-9.9%)
- 하지만 클러스터 해석은 더 명확할 수 있음

**이유**:
- 연속형 `age_scaled`, `Q6_scaled`가 세밀한 구분에 도움
- 생애주기/소득 계층은 범주형이지만, 연속형 정보가 추가 정보 제공

### 2. 피처 추가의 역효과

**실험 2 결과**:
- 추가 피처가 오히려 성능 저하 (-22.0%)
- 노이즈 증가 또는 다중공선성 문제

**권장사항**:
- 라이프스타일 피처 추가는 신중하게 접근
- 생애주기/소득과 독립적인 피처만 추가

### 3. 최종 추천

**현재 상황**:
- **기존 방식 (24개 피처)**: Silhouette Score 0.3061 (최고)
- **실험 1 (22개 피처)**: Silhouette Score 0.2759 (중복 제거)
- **실험 2 (26개 피처)**: Silhouette Score 0.2388 (피처 추가)

**권장사항**:
1. **기존 방식 유지** (24개 피처)
   - Silhouette Score가 가장 높음 (0.3061)
   - 중복이 오히려 세밀한 구분에 도움

2. **또는 실험 1 방식** (22개 피처)
   - 성능은 약간 하락하지만 클러스터 해석이 더 명확할 수 있음
   - 논문 방법론과 일치

3. **추가 실험 제안**:
   - `age_scaled`, `Q6_scaled`에 **가중치 조정** (예: 0.5배)
   - 새로운 피처 조합 테스트
   - k=9, 10도 테스트

---

## 📁 생성된 파일

### 데이터 파일
- `flc_income_clustering_optimized.csv`: 최적화된 클러스터링 결과
- `flc_income_clustering_optimized_metadata.json`: 실험 결과 메타데이터
- `flc_income_clustering_optimized_model.pkl`: 최적화된 모델

### 시각화 파일
- `visualizations/umap_optimized.png`: UMAP 2D 시각화
- `visualizations/experiment_comparison.png`: 실험 결과 비교 그래프
- `visualizations/k_optimization.png`: k값별 Silhouette Score 그래프

---

## 🔬 추가 실험 제안

### 실험 4: 가중치 조정

```python
# age_scaled, Q6_scaled에 낮은 가중치 부여
X_additional = df[additional_features].copy()
X_additional['age_scaled'] = X_additional['age_scaled'] * 0.5  # 가중치 0.5
X_additional['Q6_scaled'] = X_additional['Q6_scaled'] * 0.5    # 가중치 0.5
```

### 실험 5: 선택적 피처 추가

```python
# 생애주기/소득과 독립적인 피처만 추가
additional_features = [
    'education_level_scaled',
    'Q8_count_scaled',
    'Q8_premium_index',
    'is_premium_car',
    'is_metro'  # 지역은 생애주기/소득과 독립적
]
```

### 실험 6: k값 확장

```python
# k=9, 10도 테스트
for k in range(6, 11):
    # ...
```

---

**작성일**: 2025-01-15  
**분석자**: AI Assistant  
**목적**: FLC × Income Matrix 클러스터링 최적화 실험 결과 분석 및 권장사항 제시

